<div class="content" ng-controller="fileBrowser">
    <div class="file_browser">
        <toolbar></toolbar>
        <div class="file_list_wrapper" fix-scroll>
            <div class="file_list {{view}}_view" ng-class="showHint?'has_hint':''">
                <div class="file_list_header" ng-show="view=='list'">
                    <div class="list_header">
                        <div class="file_name" ng-class="order.indexOf('filename')>=0?'current':''" ng-click="setOrder('filename')">
                            <span>文件名</span>
                            <i ng-class="order=='-filename'?'gk_down_arrow':'gk_up_arrow'"></i>
                        </div>
                        <div class="last_edit_time" ng-class="order.indexOf('last_edit_time')>=0?'current':''"
                             ng-click="setOrder('last_edit_time')">
                            <i class="grid_line"></i>
                            <span>最后修改时间</span>
                            <i ng-class="order=='-last_edit_time'?'gk_down_arrow':'gk_up_arrow'"></i>
                        </div>
                        <div class="file_type" ng-class="order.indexOf('ext')>=0?'current':''" ng-click="setOrder('ext')">
                            <i class="grid_line"></i>
                            <span>类型</span>
                            <i ng-class="order=='-ext'?'gk_down_arrow':'gk_up_arrow'"></i>
                        </div>
                        <div class="file_size" ng-class="order.indexOf('filesize')>=0?'current':''" ng-click="setOrder('filesize')">
                            <i class="grid_line"></i>
                            <span>大小</span>
                            <i ng-class="order=='-filesize'?'gk_down_arrow':'gk_up_arrow'"></i>
                        </div>
                    </div>
                    <div class="c_f_after file_list_hint" ng-show="showHint">
                        <span class="f_l">同步的文件夹</span>
                        <a class="f_r go_to_local sync_opt btn btn-default" href="javascript:void(0)" ng-click="showSyncSetting()">
                            <i class="icon16x16 icon_sync_setting"></i>
                            <span>设置</span>
                        </a>
                        <a class="f_r go_to_local sync_opt btn btn-default " href="javascript:void(0)" ng-click="goToLocal()">
                            <i class="icon16x16 icon_open_local"></i>
                            <span>前往</span>
                        </a>
                    </div>
                </div>
                <div class="scrollbar list_body"
                     ng-drop="handleSysDrop($event)"
                     ng-mousedown="handleMouseDown($event)"
                     ng-right-click="handleRightClick($event)"

                     ng-model="testModel"
                     scroll-load= "handleScrollLoad()"
                     ng-model="testModel"
                     create-new-folder="createNewFolder"
                     create-file-submit="createFileNameSubmit(filename)"
                     keybroad-nav
                     >
                    <div class="empty" ng-if="errorMsg">
                        <span>{{errorMsg}}</span>
                    </div>
                    <div ng-if="!errorMsg">
                        <div class="item file_item"
                             rename-file="file.rename"
                             rename-file-submit = "renameFileSubmit(filename,file)"
                             ng-class="getItemClasses(file)"
                             ng-repeat="file in fileData | limitTo:limit"
                             ng-dblclick="handleDblClick(file)"
                             ng-click="handleClick($event,$index)"
                             data-fullpath="{{file.fullpath}}"
                             data-dir="{{file.dir}}"
                                >
                            <div class="thumb" ng-if="view=='thumb'">
                                <img
                                     ng-if="['jpg','jpeg','png','gif'].indexOf(file.ext)<0"
                                     ng-src="{{ file.filename | getFileThumb:file.dir:(file.open||(PAGE_CONFIG.file.sharepath?1:0)):(file.sync||PAGE_CONFIG.file.syncpath?1:0)}}" />
                                <img ng-if="['jpg','jpeg','png','gif'].indexOf(file.ext)>=0"
                                     error-src="{{file.filename | getFileThumb:file.dir:(file.open||(PAGE_CONFIG.file.sharepath?1:0)):file.sync}}"
                                     ng-src="{{file.hash | getThumbUrl:file.filehash}}" />
                                <s ng-if="file.status==2" class="icon16x16 icon_down"></s>
                                <s ng-if="file.status==1" class="icon16x16 icon_up"></s>
                            </div>
                            <div class="file_icon_wrapper">
                                   <span ng-if="view=='list'">
                                  <i class="file_icon {{file.filename | getFileIcon:file.dir:(file.open||(PAGE_CONFIG.file.sharepath?1:0)):(file.sync||PAGE_CONFIG.file.syncpath?1:0)}}" ng-if="['jpg','jpeg','png','gif'].indexOf(file.ext)>=0">
                                      <!--<img error-src=""-->
                                           <!--ng-src="{{file.hash | getThumbUrl:file.filehash}}" />-->
                                      <s ng-if="file.status==2" class="icon16x16 icon_down"></s>
                                      <s ng-if="file.status==1" class="icon16x16 icon_up"></s>
                                  </i>
                                  <i ng-if="['jpg','jpeg','png','gif'].indexOf(file.ext)<0" class="file_icon {{file.filename | getFileIcon:file.dir:(file.open||(PAGE_CONFIG.file.sharepath?1:0)):(file.sync||PAGE_CONFIG.file.syncpath?1:0)}}">
                                      <s ng-if="file.status==2" class="icon16x16 icon_down"></s>
                                      <s ng-if="file.status==1" class="icon16x16 icon_up"></s>
                                  </i>
                                </span>
                            </div>
                            <div class="file_name">
                                <span title="{{file.fullpath}}" class="name">{{file.filename}}</span>
                            </div>
                            <div class="last_edit_time" ng-if="view=='list'">
                                <span>{{file.last_edit_time*1000 | date:'yyyy/MM/dd HH:mm'}}</span>
                            </div>
                            <div class="file_type" ng-if="view=='list'">
                                <span>{{file.filename | getFileType:file.dir:file.ext}}</span>
                            </div>
                            <div class="file_size" ng-if="view=='list'">
                                <span>{{file.dir==1?'-':(file.filesize|bitSize)}}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <aside class="right_sidebar" ng-class="PAGE_CONFIG.mount.org_id==0?'my_right_sidebar':''" ng-controller="rightSidebar">
        <div ng-if="!PAGE_CONFIG.networkConnected">
            <network-unconnect></network-unconnect>
        </div>
        <div ng-if="PAGE_CONFIG.networkConnected">
            <div ng-switch="sidebar">
                <div ng-switch-when="singlefile">
                    <singlefile-right-sidebar></singlefile-right-sidebar>
                </div>
                <div ng-switch-when="multifile">
                    <multifile-right-sidebar></multifile-right-sidebar>
                </div>
                <div ng-switch-when="nofile">
                    <nofile-right-sidebar></nofile-right-sidebar>
                </div>
            </div>
        </div>
    </aside>
</div>

