<div class="single_file">
    <div ng-show="!loading">
        <div ng-if="!fileExist">
            <filter-right-sidebar></filter-right-sidebar>
        </div>
        <div ng-if="fileExist">
            <div class="file_info_wrapper">
                <div class="section_title">
                    <span class="name">{{file.filename}}</span>
                    <span class="title">
                        详细
                    </span>
                </div>
                <section class="scrollbar">
                    <div class="file_icon">
                        <img ng-src="{{file.filename | getFileThumb:file.dir}}" alt=""/>
                    </div>
                    <div class="file_attrs">
                        <div class="file_name">
                            <span title="{{file.filename}}">{{file.filename}}</span>
                        </div>
                        <div title="创建人：{{file.creator_member_name}}">创建人：<span ng-bind="file.creator_member_name"></span></div>
                        <div title="最后修改人：{{file.last_member_name}}">最后修改人：<span ng-bind="file.last_member_name"></span></div>
                        <div class="smart">
                            <a href="javascript:void(0)" ng-repeat="smart in smarts" ng-class="isSmartAdd(file.favorite,smart.filter)?'active':''" ng-click="toggleSmart(smart.filter,file.favorite)">
                                <i class="icon16x16 {{smart.icon}}" title="{{smart.name}}"></i>
                            </a>
                        </div>
                    </div>

                    <div class="tags" ng-if="file.cmd>0">
                        <tags-input ng-model="file.formatTag" class="" name="file_tag" id="file_tag" placeholder="+ 添加注释"></tags-input>
                    </div>
                </section>
            </div>
            <section class="file_detail_wrapper" ng-show="showTab">
                <tabset direction="blew">
                    <tab heading="共享">
                        <button ng-if="enableAddShare" class="btn btn-primary set_share" ng-click="showEditShareDialog()"><i class="icon16x16 icon_add_share_white"></i>添加共享</button>
                        <ul class="scrollbar share_member_list" ng-style="{top:!enableAddShare?0:''}">
                            <li class="item" ng-repeat="shareMember in shareMembers">
                        <span class="icon">
                           <avatar class="avatar avatar_mini" gk-src="{{shareMember.avatar}}"></avatar>
                        </span>
                                <span class="name">{{shareMember.member_name}}</span>
                        <span class="opts" ng-if="enableAddShare && shareMember.member_id != PAGE_CONFIG.user.member_id">
                            <button class="btn btn-danger btn-flat" ng-click="removeShare(shareMember)">删除</button>
                        </span>
                            </li>
                            <li class="item" ng-repeat="shareGroup in shareGroups">
                        <span class="icon">
                            <group-photo class="avatar avatar_mini" gk-src="{{shareGroup.photo}}"></group-photo>
                        </span>
                                <span class="name">{{shareGroup.group_name}}</span>
                        <span class="members">
                             <avatar ng-repeat="member in shareGroup.members" title="{{member.member_name}}" class="avatar avatar_mini" gk-src="{{member.avatar}}"></avatar>
                        </span>
                        <span class="opts" ng-if="enableAddShare">
                            <button class="btn btn-danger btn-flat" ng-click="removeShare(shareGroup)">删除</button>
                        </span>
                            </li>
                        </ul>
                    </tab>

                    <tab heading="讨论">
                        <div class="update_wrapper" ng-class="inputingRemark?'editing':''">
                            <div class="empty" ng-if="!remarks || !remarks.length">没有讨论</div>
                            <ul class="scrollbar update_list">
                                <li ng-repeat="remark in remarks" class="item c_f_after">
                            <span class="update_member" title="{{remark.member_name}}">
                                <avatar class="avatar avatar_mini" gk-src="{{remark.member_photo}}"></avatar>
                                <span>{{remark.member_name}}：</span>
                            </span>
                                 <span class="update_text">
                                    <span ng-bind-html="remark.render_text"></span>
                                     <span class="update_time">({{remark.dateline*1000|date:'M月d日'}})</span>
                                </span>
                                </li>
                            </ul>
                            <div class="post_wrapper">
                                <textarea class="form-control" ng-keydown="handleKeyDown($event)" placeholder="参与讨论" ng-focus="inputingRemark=true"
                                          ng-model="postText" ng-blur="inputingRemark=false" input-tip="@" input-tip-list="remindMembers" input-tip-placement="top right"></textarea>

                                <div class="post_opts">
                            <span ng-show="remindMembers && remindMembers.length">
                                <a href="javascript:void(0)" ng-click="insertAt('@')" class="f_l" title="提醒">@</a>
                            <a href="javascript:void(0)" ng-click="insertAt('@all ')" class="f_l" title="提醒所有共享者">@全部</a>
                            </span>
                                    <button class="btn btn-primary f_r" ng-click="postRemark(postText)">确定</button>
                                </div>
                            </div>
                        </div>

                    </tab>
                    <tab heading='历史'>
                        <div class="empty" ng-if="!histories || !histories.length">没有历史</div>
                        <ul class="scrollbar history_list">
                            <li class="item c_f_after" ng-class="'act_'+history.act" ng-repeat="history in histories">
                                <div class="act_name"><span>{{history.act_name}}</span></div>
                                <div class="act_info">
                                    <div> <span class="filename">{{history.fullpath|baseName}}</span></div>
                                    <div><span class="act_member" title="{{history.member_name}}">{{history.member_name}}</span><span class="act_dateline">{{history.dateline*1000 | date:'yyyy/M/d H:m'}}</span></div>
                                </div>
                                <!--<div class="act_opts dropdown">-->
                                <!--<a dropdown-toggle href="javascript:void(0);">-->
                                <!--<i class="gk_down_arrow"></i>-->
                                <!--</a>-->
                                <!--<ul class="dropdown-menu">-->
                                <!--<li>-->
                                <!--<a href="javascript:;" ng-click="openVersion()">打开</a>-->
                                <!--<a href="javascript:;" ng-click="saveVersion()">另存为</a>-->
                                <!--<a href="javascript:;" ng-click="recoveryVersion()">恢复</a>-->
                                <!--</li>-->
                                <!--</ul>-->
                                <!--</div>-->
                            </li>
                        </ul>
                    </tab>
                </tabset>
            </section>
        </div>
    </div>
</div>