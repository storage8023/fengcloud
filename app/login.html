<!DOCTYPE html>
<html ng-app = "mylogin">
<head>
    <title>login</title>
    <meta http-equiv = "content-type" content="text/html;charset = utf-8" />
    <script src="bower_components/angular/angular.js"></script>
    <script src = "bower_components/angular/angular-md5.js"></script>
    <style type = "text/css">
        #login-wrapper{
            width:300px;
            height:300px;
            margin: 0 auto;
            background: #F8F9FB;
            border:1px solid #AEBCD4;
             border-radius: 6px 6px 6px 6px;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.25);
            text-align: center;
            padding-top: 20px;
        }
    </style>
</head>
<body>
<div id = "login-wrapper">
    <form name = "myForm"  ng-controller = "loginCtrl"  ng-submit="postData() ">
            用户:<input type = "text" size = "25" name = "username" ng-model = "username" /><br /><br />
            密码:<input type = "password" size= "25" name = "userpassword" ng-model ="password" /><br /><br/>
        <input type = "submit"  value = "登录" />
    </form>
</div>
<script type = "text/javascript">
    angular.module('mylogin', [
        'angular-md5',
        'controllers'
    ]);
    var app = angular.module("controllers",[]);
    app.controller("loginCtrl",['$scope', 'md5', function($scope, md5,$http) {

	    postData($scope,$http);
        console.log($scope,$http);
        function postData(caller,http){
            $scope.$watch('password' ,function() {
                $scope.userPassword = md5.createHash($scope.password || '');

            });
            caller.postData = function(){
                if(typeof this.username === 'undefined' || typeof this.password === 'undefined') return false;

                gkClient.gLogin(JSON.stringify({username: this.username,password: this.userPassword}), function (type, error, message) {
                    if(error === 0){
                        alert("登入成功");
                    }else {
                        alert(message);
                    }
                });
            }
        }

    }]);
</script>
</body>
</html>